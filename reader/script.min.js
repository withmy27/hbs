pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js",console.log(window.location.search);const url=`https://withmy27.github.io/hbs/bulletins/${window.location.search.substring(1)??185}.pdf`,container1=document.querySelector("#con-1"),container2=document.querySelector("#con-2"),pageSlider=document.getElementById("page-slider"),prevBtn=document.getElementById("prev"),nextBtn=document.getElementById("next"),pageNum=document.getElementById("page-num"),loading=document.createElement("img");loading.src="hbs_logo.svg",loading.alt="hbs logo",loading.height="300px",loading.width="300px",loading.classList.add("loading");const minHeight=500,sqrt2=1.4142135624,revSqrt2=.7071067812,verticalMargin=80,horizontalMargin=24;let pdf=null,pdfMeta=null,currentPage=1,pageRendering=!1,pageNumPending=null,timer=null,pagePerWindow=window.innerWidth>=800?2:1,scale=null,pageHeight,pageWidth,isMouseOn=!1;async function renderSinglePage(e,n=1,t=0){if(t){let a=1===t?container1:container2;a.innerHTML="",a.style.height=0,a.style.width=0}let r=1===n?container1:container2,g=await pdf.getPage(e),i=g.getViewport({scale});r.style.height=i.height+"px",r.style.width=i.width+"px",r.innerHTML="",r.appendChild(loading),1===n&&(1===pagePerWindow?pageNum.textContent=e+" / "+pdf.numPages:2===pagePerWindow&&(pageNum.textContent=e+"-"+(e+1)+" / "+pdf.numPages));let d=new pdfjsLib.SVGGraphics(g.commonObjs,g.objs),l=await g.getOperatorList(),p=await d.getSVG(l,i);r.innerHTML="",r.appendChild(p)}async function renderPages(e){1===pagePerWindow&&await renderSinglePage(e,1,2),2===pagePerWindow&&(await renderSinglePage(e,1),await renderSinglePage(e+1,2))}function onPrevPage(){!(currentPage<=1)&&(currentPage-=pagePerWindow,pageSlider.value=currentPage,renderPages(currentPage))}function onNextPage(){!(currentPage>=pdf.numPages-pagePerWindow+1)&&(currentPage+=pagePerWindow,pageSlider.value=currentPage,renderPages(currentPage))}const pdfPromise=pdfjsLib.getDocument(url).promise;(pdf=await pdfPromise).getPage(1).then(e=>{let n=e.getViewport({scale:1});pageWidth=n.width,pageHeight=n.height,pagePerWindow=pageWidth*(scale=(window.innerHeight-80)/pageHeight)*2<window.innerWidth?2:1,scale=pageWidth*scale<window.innerWidth?scale:(window.innerWidth-24)/pageWidth,pageSlider.max=pdf.numPages-pagePerWindow+1,renderPages(currentPage),prevBtn.addEventListener("click",onPrevPage),nextBtn.addEventListener("click",onNextPage),window.addEventListener("resize",()=>{clearTimeout(timer),timer=setTimeout(()=>{pdf.getPage(1).then(e=>{let n=e.getViewport({scale:1});pageWidth=n.width,pageHeight=n.height,pagePerWindow=pageWidth*(scale=(window.innerHeight-80)/pageHeight)*2<window.innerWidth?2:1,scale=pageWidth*scale<window.innerWidth?scale:(window.innerWidth-24)/pageWidth,2===pagePerWindow&&(currentPage-=!(1&currentPage)),pageSlider.max=pdf.numPages-pagePerWindow+1,renderPages(currentPage)})},300)}),window.onkeyup=e=>{"ArrowRight"===e.key||" "===e.key?(e.preventDefault(),onNextPage()):"ArrowLeft"===e.key&&(e.preventDefault(),onPrevPage())},pageSlider.addEventListener("input",e=>{let n=parseInt(e.target.value);1===pagePerWindow?(currentPage=n,pageNum.textContent=currentPage+" / "+pdf.numPages):2===pagePerWindow&&(currentPage=(1&n)==1?n:n-1,pageNum.textContent=currentPage+"-"+(currentPage+1)+" / "+pdf.numPages),pageSlider.value=currentPage}),pageSlider.addEventListener("change",e=>{let n=parseInt(e.target.value);1===pagePerWindow?currentPage=n:2===pagePerWindow&&(currentPage=(1&n)==1?n:n-1),console.log(currentPage),renderPages(currentPage)})});